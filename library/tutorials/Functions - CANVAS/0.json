{
  "_meta": {
    "version": 19,
    "gameSettings": {
      "legacyModes": {}
    },
    "info": {
      "name": "Functions - CANVAS",
      "image": "/assets/-61205848_4168",
      "rules": "",
      "bgg": "",
      "year": "",
      "mode": "Tutorial",
      "time": "0",
      "attribution": "",
      "lastUpdate": 1763220225461,
      "showName": false,
      "skill": "",
      "description": "",
      "similarImage": "",
      "similarName": "",
      "similarDesigner": "",
      "similarAwards": "",
      "ruleText": "",
      "helpText": "",
      "variantImage": "",
      "variant": "",
      "language": "en-US",
      "players": "1"
    }
  },
  "title": {
    "id": "title",
    "x": 400,
    "y": -2,
    "width": 800,
    "height": 60,
    "z": 74,
    "movable": false,
    "movableInEdit": false,
    "css": "font-size: 60px;text-align:center",
    "text": "Functions: CANVAS",
    "layer": -3
  },
  "button2": {
    "type": "button",
    "id": "button2",
    "x": 416,
    "y": 402,
    "z": 22839,
    "clickRoutine": [
      {
        "func": "FOREACH",
        "range": [
          50
        ],
        "loopRoutine": [
          {
            "func": "CANVAS",
            "collection": [
              "canvas1"
            ],
            "mode": "setPixel",
            "x": "${value}",
            "y": "${value}",
            "value": 3
          }
        ]
      }
    ],
    "text": "setPixel"
  },
  "overview": {
    "id": "overview",
    "x": 108,
    "y": 80,
    "height": 150,
    "layer": -3,
    "z": 129,
    "movable": false,
    "movableInEdit": false,
    "css": "font-size: 25px; ",
    "html": "The CANVAS function is used to alter canvas widgets. It works on an individual canvas, an array of canvases, or a collection specified in the <b>collection</b> parameter. The function has 6 <b>mode</b>s which are demonstrated below. There is not a mode to modify the line width. To do that, use a SET function and change the <b>lineWidth</b> property on the canvas. For more information about using a canvas, look at the <a href='https://virtualtabletop.io/tutorial/types-canvas'>Canvas Widget Tutorial</a>.",
    "width": 1000
  },
  "button4": {
    "type": "button",
    "id": "button4",
    "x": 1062,
    "y": 402,
    "z": 22840,
    "clickRoutine": [
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "set",
        "value": 0
      }
    ],
    "text": "set"
  },
  "button5": {
    "type": "button",
    "id": "button5",
    "x": 1386,
    "y": 402,
    "z": 11,
    "clickRoutine": [
      {
        "func": "INPUT",
        "fields": [
          {
            "type": "title",
            "text": "Make a choice"
          },
          {
            "type": "color",
            "variable": "color",
            "label": "Choose new color"
          },
          {
            "type": "number",
            "variable": "number",
            "label": "Choose index value of color to be replaced",
            "min": 0,
            "max": 9
          }
        ]
      },
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "change",
        "color": "${color}",
        "value": "${number}"
      },
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "set",
        "value": "${value}"
      }
    ],
    "text": "change"
  },
  "text1": {
    "id": "text1",
    "x": 4,
    "y": 552,
    "width": 300,
    "z": 185,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "font-size": "22px"
    },
    "html": "This button resets the canvas. It is the same as pressing the 'Reset' button that is attached to the default canvas widget. This works by replacing all of the pixels in the canvas with the color that is in index position 0 of the <b>colorMap</b>.",
    "layer": -3
  },
  "button1": {
    "type": "button",
    "id": "button1",
    "x": 95,
    "y": 402,
    "z": 22841,
    "clickRoutine": [
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "reset"
      }
    ],
    "text": "reset"
  },
  "text2": {
    "id": "text2",
    "x": 325,
    "y": 552,
    "width": 300,
    "z": 121,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "font-size": "22px"
    },
    "html": "This mode places one pixel of the specified color in coordinates specified by <b>x</b> and <b>y</b>. The color is determined by the <b>value</b> parameter (as the index to the <b>colorMap</b> property). The max x/y values are the same as <b>resolution</b> (which defaults to 100). The example above uses a <b>FOREACH loopRoutine</b> to draw a diagonal line.",
    "layer": -3
  },
  "text3": {
    "id": "text3",
    "x": 651,
    "y": 552,
    "width": 300,
    "z": 9732,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "font-size": "22px"
    },
    "html": "The button on the left increases the index of the drawing color in the <b>colorMap</b> by the increment amount in the <b>value</b> parameter (the default of 1 in this case). This is the same as clicking on the color change button. Both methods change the <b>activeColor</b> property of the canvas.\n\nThe button on the right does the same thing except that it decreases the <b>activeColor</b> by a random number.",
    "layer": -3
  },
  "text4": {
    "id": "text4",
    "x": 964,
    "y": 552,
    "width": 300,
    "z": 9732,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "font-size": "22px"
    },
    "html": "This button sets the cavas <b>activeColor</b> (drawing color) to the index number of <b>value</b> in the <b>colorMap</b>.  In this case, the <b>activeColor</b> is set to 0, which is the background color.",
    "layer": -3
  },
  "text5": {
    "id": "text5",
    "x": 1294,
    "y": 552,
    "width": 300,
    "z": 9732,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "font-size": "22px"
    },
    "html": "This button replaces the existing index of the <b>colorMap</b> in position <b>value</b> with the color in the <b>color</b> parameter. The button uses an INPUT to let the player choose the color and position to replace. If index 0 is chosen, that will be the new background color. Using this mode immediately changes all existing pixels of the selected color on the canvas. this b",
    "layer": -3
  },
  "e4ht-Reset": {
    "type": "button",
    "id": "e4ht-Reset",
    "parent": "canvas1",
    "fixedParent": true,
    "x": -50,
    "y": 0,
    "width": 50,
    "height": 50,
    "movable": false,
    "movableInEdit": false,
    "clickRoutine": [
      {
        "func": "CANVAS",
        "canvas": "${PROPERTY parent}",
        "mode": "reset"
      }
    ],
    "css": "border-width: 1px;  --wcBorder: #555; --wcBorderOH: black; --wcMainOH: #0d2f5e; font-size:16px",
    "borderRadius": "50% 0% 0% 0%",
    "text": "Reset"
  },
  "e4ht-Size": {
    "type": "button",
    "id": "e4ht-Size",
    "parent": "canvas1",
    "fixedParent": true,
    "x": -50,
    "y": 60,
    "width": 50,
    "height": 40,
    "movableInEdit": false,
    "clickRoutine": [
      "var parent = ${PROPERTY parent}",
      "var lineSize = ${PROPERTY lineSize} + 10",
      "var lineSize = ${lineSize} % 110",
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "lineSize",
        "value": "${lineSize}"
      },
      "var finalSize = max ${lineSize} 10",
      "var newWidth = 1 + (${finalSize} - 10) / 10 * (${PROPERTY resolution OF $parent} / 200)",
      {
        "func": "SET",
        "collection": [
          "${parent}"
        ],
        "property": "lineWidth",
        "value": "${newWidth}"
      }
    ],
    "css": {
      "default": {
        "border-width": "1px",
        "background-color": "#f0f0f0",
        "--wcBorder": "#555",
        "--wcBorderOH": "black ",
        "background-repeat": "no-repeat",
        "background-position": "50% 50%",
        "background-size": "${PROPERTY lineSize}%"
      },
      "::after": {
        "content": "\"Line Width\"",
        "position": "absolute",
        "margin-top": "-5.1em",
        "color": "white",
        "background-color": "#0d2f5e",
        "width": "50px",
        "font-size": "0.6rem"
      }
    },
    "borderRadius": 0,
    "image": "/i/game-icons.net/delapouite/plain-circle.svg",
    "canvasRoutine": [
      "var parent = ${PROPERTY parent}",
      "var step = (${PROPERTY lineWidth OF $parent} - 1) / (${PROPERTY resolution OF $parent} / 200)",
      "var step = floor ${step}",
      "var percentage = 10 + ${step} * 10",
      "var percentage = min ${percentage} 100",
      "var percentage = max ${percentage} 10",
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "lineSize",
        "value": "${percentage}"
      }
    ],
    "lineSize": 10
  },
  "e4ht-Color": {
    "type": "button",
    "id": "e4ht-Color",
    "parent": "canvas1",
    "fixedParent": true,
    "x": -50,
    "y": 100,
    "width": 50,
    "height": 50,
    "movableInEdit": false,
    "clickRoutine": [
      "var parent = ${PROPERTY parent}",
      {
        "func": "CANVAS",
        "canvas": "${parent}",
        "mode": "inc",
        "value": 1
      },
      {
        "func": "CALL",
        "routine": "canvasRoutine"
      }
    ],
    "color": "#1F5CA6",
    "css": "border-width: 1px; background-color: var(--color);  --wcBorder: #555; --wcBorderOH: black  ",
    "borderRadius": "0% 0% 0% 50%",
    "canvasRoutine": [
      "var parent = ${PROPERTY parent}",
      "var color = ${PROPERTY colorMap OF $parent} getIndex ${PROPERTY activeColor OF $parent}",
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "color",
        "value": "${color}"
      }
    ]
  },
  "canvas1": {
    "type": "canvas",
    "id": "canvas1",
    "x": 1200,
    "width": 300,
    "height": 300,
    "z": 81,
    "activeColorChangeRoutine": [
      {
        "func": "CALL",
        "routine": "selectButtonRoutine",
        "arguments": {
          "buttonType": "-Color"
        }
      }
    ],
    "lineWidthChangeRoutine": [
      {
        "func": "CALL",
        "routine": "selectButtonRoutine",
        "arguments": {
          "buttonType": "-Size"
        }
      }
    ],
    "selectButtonRoutine": [
      {
        "func": "SELECT",
        "type": "button",
        "property": "parent",
        "value": "${PROPERTY id}"
      },
      {
        "func": "FOREACH",
        "loopRoutine": [
          "var isColor = ${widgetID} endsWith ${buttonType}",
          {
            "func": "IF",
            "condition": "${isColor}",
            "thenRoutine": [
              "var buttonID = ${widgetID}"
            ]
          }
        ]
      },
      {
        "func": "CALL",
        "widget": "${buttonID}",
        "routine": "canvasRoutine"
      }
    ],
    "colorMap": [
      "#f0f0f0",
      "#1F5CA6",
      "#000000",
      "#FF0000",
      "#008000",
      "#FFFF00",
      "#FFA500",
      "#FFC0CB",
      "#800080",
      "#A52A2A"
    ],
    "movable": false,
    "y": 80
  },
  "button3a": {
    "type": "button",
    "id": "button3a",
    "x": 667,
    "y": 402,
    "z": 22840,
    "clickRoutine": [
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "inc"
      }
    ],
    "text": "inc"
  },
  "button3b": {
    "type": "button",
    "id": "button3b",
    "x": 811,
    "y": 402,
    "z": 22840,
    "clickRoutine": [
      "var random = randInt 1 9",
      {
        "func": "CANVAS",
        "collection": [
          "canvas1"
        ],
        "mode": "dec",
        "value": "${random}"
      }
    ],
    "text": "dec"
  }
}