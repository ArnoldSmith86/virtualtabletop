{
  "_meta": {
    "version": 12,
    "info": {
      "name": "Knaves",
      "image": "/assets/783447468_37754",
      "rules": "",
      "bgg": "https://boardgamegeek.com/boardgame/31255/knaves",
      "year": "1850",
      "mode": "vs",
      "time": "30",
      "attribution": "Room layout and design by anewcar and released to the public domain by CC0.\n<br><div>Game image is Knight by Amethyst Studio from Noun Project as CC BY 3.0 at https://thenounproject.com/icon/knight-4131497/.</div><div><br></div><div>Background generated by heropatterns.com and available as CC BY 4.0.&nbsp;<br><div><br></div></div><div><br></div>",
      "id": "pzxq",
      "showName": true,
      "skill": "",
      "description": "A trick taking game for 3 players. Gain points for winning tricks and lose points for winning Knaves (Jacks). First player to 20 wins.",
      "similarImage": "",
      "similarName": "",
      "similarAwards": "",
      "ruleText": "Deal 17 cards to each player. The leftover card is turned face up and the suit of this card is trump for the hand.&nbsp;<div><br></div><div>First player rotates in each round, starting with player 1. Any card can be led. Each player going clockwise, plays a card to the trick. If you can follow suit, you must and if you can't, you may play anything.&nbsp;&nbsp;</div><div><br></div><div>When everyone has played a card to the trick the winner is the player who played the highest trump or (if no trumps were played to the trick) the highest led suit. The winner leads to the next trick.&nbsp;</div><div><br></div><div>At the end of the hand, when all cards have been played, each player's score is determined as follows:&nbsp;</div><div><ul><li>&nbsp;1 point for each trick they have won&nbsp;</li><li>-4 if they won a trick with the Jack of Hearts in it</li><li>-3 if they won a trick with the Jack of Diamonds in it</li><li>-2 if they won a trick with the Jack of Clubs in it</li><li>-1 if they won a trick with the Jack of Spades in it</li></ul></div><div><div>Keep playing rounds until a player has a total score of 20 or more. The player with the highest score wins.&nbsp;</div></div>",
      "helpText": "Players take seats. Press deal button. Click cards to play. Only cards that are legal plays can be clicked. At the end of the round, press Score button and won tricks are returned to players' hands. Scorekeeping is automatic. Press deal to begin next round.",
      "lastUpdate": 1680378024752,
      "variantImage": "",
      "variant": "Main",
      "language": "en-UK",
      "players": "3"
    }
  },
  "iu0iB": {
    "id": "iu0iB",
    "parent": "deckH",
    "fixedParent": true,
    "y": 171.36,
    "width": 111,
    "height": 40,
    "type": "button",
    "text": "Recall & Shuffle",
    "movableInEdit": false,
    "clickRoutine": [
      {
        "func": "RECALL",
        "holder": "${PROPERTY parent}"
      },
      {
        "func": "FLIP",
        "holder": "${PROPERTY parent}",
        "face": 0
      },
      {
        "func": "SHUFFLE",
        "holder": "${PROPERTY parent}"
      }
    ]
  },
  "iu0i_A_D": {
    "id": "iu0i_A_D",
    "parent": "hn63",
    "deck": "deck",
    "type": "card",
    "cardType": "D 01",
    "z": 39165,
    "enabled": true,
    "undoProperties": {
      "1": {
        "parent": "hand",
        "owner": "Noopsy"
      },
      "3": {
        "activeFace": 1
      },
      "4": {}
    },
    "activeFace": 2
  },
  "rnyqC": {
    "id": "rnyqC",
    "parent": "seat1",
    "fixedParent": true,
    "x": -20,
    "y": -20,
    "width": 30,
    "height": 30,
    "borderRadius": 100,
    "movable": false,
    "movableInEdit": false,
    "clickable": false,
    "css": {
      "font-size": "18px",
      "display": "flex",
      "align-items": "center",
      "justify-content": "center",
      "color": "#6d6d6d",
      "background": "#e4e4e4",
      "border": "2px solid #999999"
    },
    "text": 0,
    "ownerGlobalUpdateRoutine": [
      "var parent = ${PROPERTY parent}",
      "var COUNT = 0",
      {
        "func": "COUNT",
        "holder": "${PROPERTY hand OF $parent}",
        "owner": "${PROPERTY player OF $parent}"
      },
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "text",
        "value": "${COUNT}"
      }
    ],
    "playerGlobalUpdateRoutine": [
      {
        "func": "CALL",
        "routine": "ownerGlobalUpdateRoutine",
        "widget": "${PROPERTY id}"
      }
    ]
  },
  "rnyqC1": {
    "id": "rnyqC1",
    "parent": "seat2",
    "fixedParent": true,
    "x": -20,
    "y": -20,
    "width": 30,
    "height": 30,
    "borderRadius": 100,
    "movable": false,
    "movableInEdit": false,
    "clickable": false,
    "css": {
      "font-size": "18px",
      "display": "flex",
      "align-items": "center",
      "justify-content": "center",
      "color": "#6d6d6d",
      "background": "#e4e4e4",
      "border": "2px solid #999999"
    },
    "text": 0,
    "ownerGlobalUpdateRoutine": [
      "var parent = ${PROPERTY parent}",
      "var COUNT = 0",
      {
        "func": "COUNT",
        "holder": "${PROPERTY hand OF $parent}",
        "owner": "${PROPERTY player OF $parent}"
      },
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "text",
        "value": "${COUNT}"
      }
    ],
    "playerGlobalUpdateRoutine": [
      {
        "func": "CALL",
        "routine": "ownerGlobalUpdateRoutine",
        "widget": "${PROPERTY id}"
      }
    ]
  },
  "rnyqC2": {
    "id": "rnyqC2",
    "parent": "seat3",
    "fixedParent": true,
    "x": -20,
    "y": -20,
    "width": 30,
    "height": 30,
    "borderRadius": 100,
    "movable": false,
    "movableInEdit": false,
    "clickable": false,
    "css": {
      "font-size": "18px",
      "display": "flex",
      "align-items": "center",
      "justify-content": "center",
      "color": "#6d6d6d",
      "background": "#e4e4e4",
      "border": "2px solid #999999"
    },
    "text": 0,
    "ownerGlobalUpdateRoutine": [
      "var parent = ${PROPERTY parent}",
      "var COUNT = 0",
      {
        "func": "COUNT",
        "holder": "${PROPERTY hand OF $parent}",
        "owner": "${PROPERTY player OF $parent}"
      },
      {
        "func": "SET",
        "collection": "thisButton",
        "property": "text",
        "value": "${COUNT}"
      }
    ],
    "playerGlobalUpdateRoutine": [
      {
        "func": "CALL",
        "routine": "ownerGlobalUpdateRoutine",
        "widget": "${PROPERTY id}"
      }
    ]
  },
  "hand": {
    "type": "holder",
    "onEnter": {
      "activeFace": 1,
      "css": {
        ":hover": {
          "box-shadow": "0px 0px 10px 5px blue"
        }
      }
    },
    "onLeave": {
      "activeFace": 0
    },
    "dropOffsetX": 10,
    "dropOffsetY": 14,
    "stackOffsetX": 40,
    "childrenPerOwner": true,
    "dropShadow": true,
    "y": 820,
    "width": 763,
    "height": 180,
    "id": "hand",
    "x": 350
  },
  "r45z": {
    "type": "button",
    "text": "DEAL",
    "clickRoutine": [
      {
        "func": "CALL",
        "widget": "title",
        "routine": "propertiesRoutine",
        "arguments": {
          "properties": "dealProperties"
        }
      },
      {
        "func": "RECALL",
        "holder": "deckH"
      },
      {
        "func": "FLIP",
        "holder": "deckH",
        "face": 0
      },
      {
        "func": "SHUFFLE",
        "holder": "deckH"
      },
      {
        "func": "MOVE",
        "to": [
          "trumpH"
        ],
        "from": "deckH",
        "count": 1
      },
      {
        "func": "FLIP",
        "holder": "trumpH",
        "face": 1
      },
      {
        "func": "SELECT",
        "type": "seat",
        "property": "player",
        "relation": "!=",
        "value": "",
        "collection": "seats"
      },
      {
        "func": "FOREACH",
        "collection": "seats",
        "loopRoutine": [
          {
            "func": "MOVE",
            "to": [
              "${widgetID}"
            ],
            "from": "deckH",
            "count": 17
          }
        ]
      },
      {
        "func": "SET",
        "property": "turn",
        "value": false,
        "collection": "seats"
      },
      "var round = ${PROPERTY text OF roundL}",
      "var round = ${round} % 3",
      {
        "func": "IF",
        "operand1": "${round}",
        "operand2": 0,
        "thenRoutine": [
          "var round = 3"
        ]
      },
      "var seatID = 'seat' concat ${round}",
      {
        "func": "SET",
        "collection": [
          "${seatID}"
        ],
        "property": "turn",
        "value": true
      },
      {
        "func": "CLICK",
        "collection": [
          "sortB"
        ],
        "count": 4
      },
      {
        "func": "SELECT",
        "property": "undoProperties",
        "relation": "!=",
        "value": null
      },
      {
        "func": "FOREACH",
        "loopRoutine": [
          {
            "func": "SET",
            "property": "undoProperties",
            "value": null
          }
        ]
      },
      {
        "func": "SET",
        "collection": [
          "${thisID}"
        ],
        "property": "scale",
        "value": 0
      }
    ],
    "x": 1338,
    "y": 61,
    "z": 149,
    "id": "r45z",
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;font-size: 25px",
    "resetProperties": {
      "scale": 1
    }
  },
  "deckH": {
    "type": "holder",
    "id": "deckH",
    "x": 642,
    "y": 1287,
    "z": 70,
    "dropTarget": {
      "type": "card"
    }
  },
  "deck": {
    "type": "deck",
    "id": "deck",
    "parent": "deckH",
    "x": 12,
    "y": 41,
    "cardTypes": {
      "C 02": {
        "image": "/i/cards-default/2C.svg",
        "suit": "C",
        "rank": "02",
        "sortingKey": 1
      },
      "C 03": {
        "image": "/i/cards-default/3C.svg",
        "suit": "C",
        "rank": "03",
        "sortingKey": 2
      },
      "C 04": {
        "image": "/i/cards-default/4C.svg",
        "suit": "C",
        "rank": "04",
        "sortingKey": 3
      },
      "C 05": {
        "image": "/i/cards-default/5C.svg",
        "suit": "C",
        "rank": "05",
        "sortingKey": 4
      },
      "C 06": {
        "image": "/i/cards-default/6C.svg",
        "suit": "C",
        "rank": "06",
        "sortingKey": 5
      },
      "C 07": {
        "image": "/i/cards-default/7C.svg",
        "suit": "C",
        "rank": "07",
        "sortingKey": 6
      },
      "C 08": {
        "image": "/i/cards-default/8C.svg",
        "suit": "C",
        "rank": "08",
        "sortingKey": 7
      },
      "C 09": {
        "image": "/i/cards-default/9C.svg",
        "suit": "C",
        "rank": "09",
        "sortingKey": 8
      },
      "C 10": {
        "image": "/i/cards-default/TC.svg",
        "suit": "C",
        "rank": "10",
        "sortingKey": 9
      },
      "C 2J": {
        "image": "/i/cards-default/JC.svg",
        "suit": "C",
        "rank": "11",
        "sortingKey": 10,
        "points": -2
      },
      "C 3Q": {
        "image": "/i/cards-default/QC.svg",
        "suit": "C",
        "rank": "12",
        "sortingKey": 11
      },
      "C 4K": {
        "image": "/i/cards-default/KC.svg",
        "suit": "C",
        "rank": "13",
        "sortingKey": 12
      },
      "C 01": {
        "image": "/i/cards-default/AC.svg",
        "suit": "C",
        "rank": "14",
        "sortingKey": 13
      },
      "D 02": {
        "image": "/i/cards-default/2D.svg",
        "suit": "D",
        "rank": "02",
        "sortingKey": 14
      },
      "D 03": {
        "image": "/i/cards-default/3D.svg",
        "suit": "D",
        "rank": "03",
        "sortingKey": 15
      },
      "D 04": {
        "image": "/i/cards-default/4D.svg",
        "suit": "D",
        "rank": "04",
        "sortingKey": 16
      },
      "D 05": {
        "image": "/i/cards-default/5D.svg",
        "suit": "D",
        "rank": "05",
        "sortingKey": 17
      },
      "D 06": {
        "image": "/i/cards-default/6D.svg",
        "suit": "D",
        "rank": "06",
        "sortingKey": 18
      },
      "D 07": {
        "image": "/i/cards-default/7D.svg",
        "suit": "D",
        "rank": "07",
        "sortingKey": 19
      },
      "D 08": {
        "image": "/i/cards-default/8D.svg",
        "suit": "D",
        "rank": "08",
        "sortingKey": 20
      },
      "D 09": {
        "image": "/i/cards-default/9D.svg",
        "suit": "D",
        "rank": "09",
        "sortingKey": 21
      },
      "D 10": {
        "image": "/i/cards-default/TD.svg",
        "suit": "D",
        "rank": "10",
        "sortingKey": 22
      },
      "D 2J": {
        "image": "/i/cards-default/JD.svg",
        "suit": "D",
        "rank": "11",
        "sortingKey": 23,
        "points": -3
      },
      "D 3Q": {
        "image": "/i/cards-default/QD.svg",
        "suit": "D",
        "rank": "12",
        "sortingKey": 24
      },
      "D 4K": {
        "image": "/i/cards-default/KD.svg",
        "suit": "D",
        "rank": "13",
        "sortingKey": 25
      },
      "D 01": {
        "image": "/i/cards-default/AD.svg",
        "suit": "D",
        "rank": "14",
        "sortingKey": 26
      },
      "S 02": {
        "image": "/i/cards-default/2S.svg",
        "suit": "S",
        "rank": "02",
        "sortingKey": 27
      },
      "S 03": {
        "image": "/i/cards-default/3S.svg",
        "suit": "S",
        "rank": "03",
        "sortingKey": 28
      },
      "S 04": {
        "image": "/i/cards-default/4S.svg",
        "suit": "S",
        "rank": "04",
        "sortingKey": 29
      },
      "S 05": {
        "image": "/i/cards-default/5S.svg",
        "suit": "S",
        "rank": "05",
        "sortingKey": 30
      },
      "S 06": {
        "image": "/i/cards-default/6S.svg",
        "suit": "S",
        "rank": "06",
        "sortingKey": 31
      },
      "S 07": {
        "image": "/i/cards-default/7S.svg",
        "suit": "S",
        "rank": "07",
        "sortingKey": 32
      },
      "S 08": {
        "image": "/i/cards-default/8S.svg",
        "suit": "S",
        "rank": "08",
        "sortingKey": 33
      },
      "S 09": {
        "image": "/i/cards-default/9S.svg",
        "suit": "S",
        "rank": "09",
        "sortingKey": 34
      },
      "S 10": {
        "image": "/i/cards-default/TS.svg",
        "suit": "S",
        "rank": "10",
        "sortingKey": 35
      },
      "S 2J": {
        "image": "/i/cards-default/JS.svg",
        "suit": "S",
        "rank": "11",
        "sortingKey": 36,
        "points": -1
      },
      "S 3Q": {
        "image": "/i/cards-default/QS.svg",
        "suit": "S",
        "rank": "12",
        "sortingKey": 37
      },
      "S 4K": {
        "image": "/i/cards-default/KS.svg",
        "suit": "S",
        "rank": "13",
        "sortingKey": 38
      },
      "S 01": {
        "image": "/i/cards-default/AS.svg",
        "suit": "S",
        "rank": "14",
        "sortingKey": 39
      },
      "H 02": {
        "image": "/i/cards-default/2H.svg",
        "suit": "H",
        "rank": "02",
        "sortingKey": 40
      },
      "H 03": {
        "image": "/i/cards-default/3H.svg",
        "suit": "H",
        "rank": "03",
        "sortingKey": 41
      },
      "H 04": {
        "image": "/i/cards-default/4H.svg",
        "suit": "H",
        "rank": "04",
        "sortingKey": 42
      },
      "H 05": {
        "image": "/i/cards-default/5H.svg",
        "suit": "H",
        "rank": "05",
        "sortingKey": 43
      },
      "H 06": {
        "image": "/i/cards-default/6H.svg",
        "suit": "H",
        "rank": "06",
        "sortingKey": 44
      },
      "H 07": {
        "image": "/i/cards-default/7H.svg",
        "suit": "H",
        "rank": "07",
        "sortingKey": 45
      },
      "H 08": {
        "image": "/i/cards-default/8H.svg",
        "suit": "H",
        "rank": "08",
        "sortingKey": 46
      },
      "H 09": {
        "image": "/i/cards-default/9H.svg",
        "suit": "H",
        "rank": "09",
        "sortingKey": 47
      },
      "H 10": {
        "image": "/i/cards-default/TH.svg",
        "suit": "H",
        "rank": "10",
        "sortingKey": 48
      },
      "H 2J": {
        "image": "/i/cards-default/JH.svg",
        "suit": "H",
        "rank": "11",
        "sortingKey": 49,
        "points": -4
      },
      "H 3Q": {
        "image": "/i/cards-default/QH.svg",
        "suit": "H",
        "rank": "12",
        "sortingKey": 50
      },
      "H 4K": {
        "image": "/i/cards-default/KH.svg",
        "suit": "H",
        "rank": "13",
        "sortingKey": 51
      },
      "H 01": {
        "image": "/i/cards-default/AH.svg",
        "suit": "H",
        "rank": "14",
        "sortingKey": 52
      }
    },
    "faceTemplates": [
      {
        "border": false,
        "radius": false,
        "objects": [
          {
            "type": "image",
            "x": 0,
            "y": 0,
            "width": 103,
            "height": 160,
            "color": "transparent",
            "value": "/i/cards-default/2B.svg"
          }
        ]
      },
      {
        "border": false,
        "radius": false,
        "objects": [
          {
            "type": "image",
            "x": 0,
            "y": 0,
            "width": 103,
            "height": 160,
            "color": "transparent",
            "dynamicProperties": {
              "value": "image"
            }
          },
          {
            "type": "text",
            "x": 5,
            "y": 135,
            "width": 103,
            "height": 160,
            "dynamicProperties": {
              "value": "points"
            }
          }
        ]
      },
      {
        "border": false,
        "radius": false,
        "objects": [
          {
            "type": "image",
            "x": 0,
            "y": 0,
            "width": 103,
            "height": 160,
            "color": "transparent",
            "dynamicProperties": {
              "value": "image"
            }
          },
          {
            "type": "text",
            "x": 5,
            "y": 135,
            "width": 103,
            "height": 160,
            "dynamicProperties": {
              "value": "points"
            }
          },
          {
            "width": 103,
            "height": 160,
            "type": "image",
            "color": "white",
            "value": "",
            "css": "opacity: 0.8"
          }
        ]
      }
    ],
    "cardDefaults": {
      "points": "",
      "movable": false,
      "transition": "transform 600ms",
      "css": {
        "default": {
          "transition": "${PROPERTY transition}"
        }
      },
      "dealProperties": {
        "enabled": true,
        "css": null
      },
      "clickRoutine": [
        {
          "func": "IF",
          "condition": "${PROPERTY enabled}",
          "thenRoutine": [
            {
              "func": "SELECT",
              "type": "seat",
              "property": "player",
              "value": "${PROPERTY owner}",
              "collection": "seat"
            },
            {
              "func": "GET",
              "collection": "seat",
              "property": "turn",
              "variable": "seatTurn"
            },
            {
              "func": "IF",
              "condition": "${seatTurn}",
              "thenRoutine": [
                {
                  "func": "GET",
                  "collection": "seat",
                  "property": "id",
                  "variable": "seatID"
                },
                {
                  "func": "CALL",
                  "widget": "undoB",
                  "routine": "updateUndoLevelRoutine",
                  "arguments": {
                    "seat": "${seatID}"
                  }
                },
                {
                  "func": "CALL",
                  "widget": "undoB",
                  "routine": "setRoutine",
                  "arguments": {
                    "widget": "${thisID}",
                    "property": "parent",
                    "value": "play${seatID.4}"
                  }
                },
                {
                  "func": "CALL",
                  "widget": "play${seatID.4}",
                  "routine": "cardPlayedRoutine",
                  "arguments": {
                    "cardID": "${thisID}"
                  }
                },
                {
                  "func": "CALL",
                  "widget": "undoB",
                  "routine": "setRoutine",
                  "arguments": {
                    "widget": "${thisID}",
                    "property": "owner",
                    "value": null
                  }
                },
                {
                  "func": "SORT",
                  "holder": "hand",
                  "key": null
                }
              ]
            }
          ]
        }
      ]
    }
  },
  "seat1": {
    "type": "seat",
    "id": "seat1",
    "x": 450,
    "y": 450,
    "z": 116,
    "dealProperties": {
      "turn": false
    },
    "score": [],
    "resetProperties": {
      "turn": false,
      "score": []
    },
    "hideWhenUnused": true
  },
  "seat2": {
    "type": "seat",
    "id": "seat2",
    "x": 663,
    "y": 450,
    "z": 144,
    "index": 2,
    "color": "#999999",
    "width": 150,
    "height": 40,
    "movable": false,
    "movableInEdit": true,
    "inheritFrom": {
      "seat1": [
        "dealProperties",
        "resetProperties"
      ]
    },
    "turn": false,
    "score": [],
    "hideWhenUnused": true
  },
  "seat3": {
    "type": "seat",
    "id": "seat3",
    "x": 875,
    "y": 450,
    "z": 117,
    "index": 3,
    "color": "#999999",
    "width": 150,
    "height": 40,
    "movable": false,
    "movableInEdit": true,
    "inheritFrom": {
      "seat1": [
        "dealProperties",
        "resetProperties"
      ]
    },
    "score": [],
    "turn": false,
    "hideWhenUnused": true
  },
  "trumpH": {
    "type": "holder",
    "id": "trumpH",
    "x": 1448,
    "y": 45,
    "z": 58,
    "enterRoutine": [
      {
        "func": "GET",
        "property": "suit",
        "collection": "child",
        "variable": "trumpSuit"
      },
      {
        "func": "SET",
        "property": "trumpSuit",
        "value": "${trumpSuit}",
        "collection": [
          "title"
        ]
      }
    ]
  },
  "play1": {
    "type": "holder",
    "id": "play1",
    "x": 477,
    "y": 540,
    "z": 49,
    "onEnter": {
      "css": null
    },
    "css": {
      ".winning": {
        "background-color": "green"
      }
    },
    "classes": "transparent",
    "cardPlayedRoutine": [
      "var playedCardID = ${cardID}",
      "var winningCard = ${PROPERTY winningCard OF title}",
      "var winningSeat = ${PROPERTY winningSeat OF title}",
      {
        "func": "IF",
        "operand1": "${PROPERTY winningCard OF title}",
        "operand2": null,
        "thenRoutine": [
          "var winningCard = ${playedCardID}",
          "var winningSeat = 'seat' concat ${thisID.4}",
          {
            "func": "CALL",
            "widget": "title",
            "routine": "validateHandsRoutine",
            "arguments": {
              "seatID": "${thisID}",
              "cardID": "${playedCardID}",
              "newTrick": true
            }
          }
        ],
        "elseRoutine": [
          "var playedSuit = ${PROPERTY suit OF $playedCardID}",
          "var playedRank = ${PROPERTY rank OF $playedCardID}",
          "var winningCard = ${PROPERTY winningCard OF title}",
          "var winningSuit = ${PROPERTY suit OF $winningCard}",
          "var winningRank  = ${PROPERTY rank OF $winningCard}",
          {
            "func": "IF",
            "operand1": "${playedSuit}",
            "operand2": "${winningSuit}",
            "thenRoutine": [
              {
                "func": "IF",
                "operand1": "${playedRank}",
                "relation": ">",
                "operand2": "${winningRank}",
                "thenRoutine": [
                  "var winningCard = ${playedCardID}",
                  "var winningSeat = 'seat' concat ${thisID.4}"
                ]
              }
            ],
            "elseRoutine": [
              "var trumpSuit = ${PROPERTY trumpSuit OF title}",
              {
                "func": "IF",
                "operand1": "${playedSuit}",
                "operand2": "${trumpSuit}",
                "thenRoutine": [
                  "var winningCard = ${playedCardID}",
                  "var winningSeat = 'seat' concat ${thisID.4}"
                ]
              }
            ]
          }
        ]
      },
      {
        "func": "CALL",
        "widget": "undoB",
        "routine": "setRoutine",
        "arguments": {
          "widget": "title",
          "property": "winningCard",
          "value": "${winningCard}"
        }
      },
      {
        "func": "CALL",
        "widget": "undoB",
        "routine": "setRoutine",
        "arguments": {
          "widget": "title",
          "property": "winningSeat",
          "value": "${winningSeat}"
        }
      },
      "var playedCardCount = ${PROPERTY playedCards OF title}",
      "var playedCardCount = ${playedCardCount} + 1",
      {
        "func": "CALL",
        "widget": "undoB",
        "routine": "setRoutine",
        "arguments": {
          "widget": "title",
          "property": "playedCards",
          "value": "${playedCardCount}"
        }
      },
      {
        "func": "CALL",
        "widget": "title",
        "routine": "playedCardsUpdatedRoutine"
      }
    ]
  },
  "title": {
    "id": "title",
    "x": 555,
    "z": 68,
    "text": "Knaves",
    "propertiesRoutine": [
      {
        "func": "SELECT",
        "property": "${properties}",
        "relation": "!=",
        "value": null
      },
      {
        "func": "FOREACH",
        "loopRoutine": [
          {
            "func": "FOREACH",
            "in": "${PROPERTY $properties OF $widgetID}",
            "loopRoutine": [
              {
                "func": "SET",
                "property": "${key}",
                "value": "${value}"
              }
            ]
          }
        ]
      }
    ],
    "dealProperties": {
      "playedCards": 0,
      "winningCard": null,
      "winningSeat": null,
      "wonSeat": null
    },
    "playedCards": 3,
    "playedCardsUpdatedRoutine": [
      {
        "func": "SELECT",
        "type": "card",
        "property": "parent",
        "relation": "in",
        "value": [
          "play1",
          "play2",
          "play3"
        ],
        "collection": "cards"
      },
      {
        "func": "IF",
        "operand1": "${PROPERTY playedCards}",
        "operand2": 3,
        "thenRoutine": [
          {
            "func": "FOREACH",
            "collection": "cards",
            "loopRoutine": [
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "${widgetID}",
                  "property": "enabled",
                  "value": false
                }
              }
            ]
          },
          {
            "func": "FOREACH",
            "in": [
              "seat1",
              "seat2",
              "seat3"
            ],
            "loopRoutine": [
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "${value}",
                  "property": "turn",
                  "value": false
                }
              }
            ]
          },
          {
            "func": "SELECT",
            "property": "parent",
            "value": "hand",
            "collection": "handCards"
          },
          {
            "func": "COUNT",
            "collection": "handCards",
            "variable": "handCardsCount"
          },
          "var turnSeat = ${PROPERTY winningSeat OF title}",
          {
            "func": "CALL",
            "widget": "undoB",
            "routine": "setRoutine",
            "arguments": {
              "widget": "${turnSeat}",
              "property": "turn",
              "value": true
            }
          },
          {
            "func": "CALL",
            "widget": "undoB",
            "routine": "setRoutine",
            "arguments": {
              "widget": "takeB",
              "property": "onlyVisibleForSeat",
              "value": "${turnSeat}"
            }
          },
          {
            "func": "IF",
            "operand1": "${handCardsCount}",
            "operand2": 0,
            "thenRoutine": [
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "scoreB",
                  "property": "scale",
                  "value": 1
                }
              }
            ],
            "elseRoutine": [
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "title",
                  "property": "wonSeat",
                  "value": "${turnSeat}"
                }
              },
              {
                "func": "CALL",
                "widget": "title",
                "routine": "propertiesRoutine",
                "arguments": {
                  "properties": "trickProperties"
                }
              },
              {
                "func": "CALL",
                "widget": "title",
                "routine": "validateHandsRoutine",
                "arguments": {
                  "newTrick": false
                }
              }
            ]
          }
        ],
        "elseRoutine": [
          {
            "func": "IF",
            "operand1": "${PROPERTY playedCards}",
            "operand2": 4,
            "thenRoutine": [
              {
                "func": "SELECT",
                "type": "card",
                "property": "enabled",
                "value": false,
                "source": "cards",
                "collection": "oldCards"
              },
              "var wonSeat = ${PROPERTY wonSeat}",
              {
                "func": "FOREACH",
                "collection": "oldCards",
                "loopRoutine": [
                  {
                    "func": "CALL",
                    "widget": "undoB",
                    "routine": "setRoutine",
                    "arguments": {
                      "widget": "${widgetID}",
                      "property": "parent",
                      "value": "won${wonSeat.4}"
                    }
                  },
                  {
                    "func": "CALL",
                    "widget": "undoB",
                    "routine": "setRoutine",
                    "arguments": {
                      "widget": "${widgetID}",
                      "property": "activeFace",
                      "value": 0
                    }
                  }
                ]
              },
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "${thisID}",
                  "property": "playedCards",
                  "value": 1
                }
              },
              {
                "func": "CALL",
                "widget": "${thisID}",
                "routine": "playedCardsUpdatedRoutine"
              }
            ],
            "elseRoutine": [
              {
                "func": "SELECT",
                "type": "seat",
                "property": "turn",
                "value": true,
                "collection": "currentTurn"
              },
              {
                "func": "GET",
                "property": "index",
                "collection": "currentTurn",
                "variable": "currentTurnIndex"
              },
              {
                "func": "FOREACH",
                "collection": [
                  "seat1",
                  "seat2",
                  "seat3"
                ],
                "loopRoutine": [
                  {
                    "func": "CALL",
                    "widget": "undoB",
                    "routine": "setRoutine",
                    "arguments": {
                      "widget": "${widgetID}",
                      "property": "turn",
                      "value": false
                    }
                  }
                ]
              },
              "var currentTurnIndex = ${currentTurnIndex} + 1",
              "var currentTurnIndex = ${currentTurnIndex} % 3",
              {
                "func": "IF",
                "operand1": "${currentTurnIndex}",
                "operand2": 0,
                "thenRoutine": [
                  "var currentTurnIndex = 3"
                ]
              },
              {
                "func": "SELECT",
                "type": "seat",
                "property": "index",
                "value": "${currentTurnIndex}",
                "collection": "nextTurn"
              },
              {
                "func": "FOREACH",
                "collection": "nextTurn",
                "loopRoutine": [
                  {
                    "func": "CALL",
                    "widget": "undoB",
                    "routine": "setRoutine",
                    "arguments": {
                      "widget": "${widgetID}",
                      "property": "turn",
                      "value": true
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "trumpSuit": "D",
    "trickProperties": {
      "winningCard": null,
      "winningSeat": null
    },
    "css": {
      "default": "font-size: 80px; font-weight: bold;text-align: center;",
      "::after": {
        "content": "\"Must follow trick taker / Trump is suit of upturned card / Highest turmp or highest led suit wins trick / Winner leads next trick \\a 1 point for each trick won / - 4 points for Jack of ♥ / -3 points for Jack of ♦ / -2 points for Jack of ♣ / -1 point for Jack of ♠ \\a First player to 20 points wins\"",
        "display": "none",
        "position": "absolute",
        "margin-left": "-280px",
        "margin-right": "2px",
        "color": "black",
        "background-color": "white",
        "text-align": "center",
        "font-size": "16px",
        "font-weight": "normal",
        "width": "900px"
      },
      ":hover::after": {
        "display": "block",
        "white-space": "pre"
      }
    },
    "validateHandsRoutine": [
      {
        "func": "IF",
        "operand1": "${newTrick}",
        "operand2": true,
        "thenRoutine": [
          "var playedSeat = 'seat' concat ${seatID.4}",
          "var playedCard = ${cardID}",
          {
            "func": "SELECT",
            "type": "seat",
            "property": "player",
            "relation": "!=",
            "value": "",
            "collection": "seats"
          },
          {
            "func": "FOREACH",
            "collection": "seats",
            "loopRoutine": [
              "var outerWidgetID = ${widgetID}",
              "var playedSuit = ${PROPERTY suit OF $playedCard}",
              {
                "func": "IF",
                "operand1": "${playedSeat}",
                "operand2": "${outerWidgetID}",
                "elseRoutine": [
                  "var widgetPlayer = ${PROPERTY player OF $outerWidgetID}",
                  {
                    "func": "SELECT",
                    "type": "card",
                    "property": "owner",
                    "value": "${widgetPlayer}",
                    "collection": "handCards"
                  },
                  {
                    "func": "SELECT",
                    "type": "card",
                    "property": "suit",
                    "value": "${playedSuit}",
                    "source": "handCards",
                    "collection": "suitHandCards"
                  },
                  {
                    "func": "COUNT",
                    "collection": "suitHandCards",
                    "variable": "suitHandCardsCount"
                  },
                  {
                    "func": "IF",
                    "operand1": "${suitHandCardsCount}",
                    "operand2": 0,
                    "elseRoutine": [
                      {
                        "func": "SELECT",
                        "type": "card",
                        "property": "suit",
                        "relation": "!=",
                        "value": "${playedSuit}",
                        "source": "handCards",
                        "collection": "nonSuitHandCards"
                      },
                      {
                        "func": "FOREACH",
                        "collection": "nonSuitHandCards",
                        "loopRoutine": [
                          {
                            "func": "CALL",
                            "widget": "undoB",
                            "routine": "setRoutine",
                            "arguments": {
                              "widget": "${widgetID}",
                              "property": "enabled",
                              "value": false
                            }
                          },
                          {
                            "func": "CALL",
                            "widget": "undoB",
                            "routine": "setRoutine",
                            "arguments": {
                              "widget": "${widgetID}",
                              "property": "activeFace",
                              "value": 2
                            }
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "elseRoutine": [
          {
            "func": "SELECT",
            "type": "card",
            "property": "_ancestor",
            "value": "hand",
            "collection": "allHandCards"
          },
          {
            "func": "FOREACH",
            "collection": "allHandCards",
            "loopRoutine": [
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "${widgetID}",
                  "property": "enabled",
                  "value": true
                }
              },
              {
                "func": "CALL",
                "widget": "undoB",
                "routine": "setRoutine",
                "arguments": {
                  "widget": "${widgetID}",
                  "property": "activeFace",
                  "value": 1
                }
              }
            ]
          }
        ]
      }
    ],
    "enabled": false,
    "width": 400,
    "y": 40,
    "wonSeat": "seat1"
  },
  "won1": {
    "type": "holder",
    "id": "won1",
    "x": 477,
    "y": 256,
    "z": 52,
    "classes": "transparent"
  },
  "won2": {
    "type": "holder",
    "id": "won2",
    "x": 688,
    "y": 256,
    "z": 68,
    "classes": "transparent"
  },
  "won3": {
    "type": "holder",
    "id": "won3",
    "x": 898,
    "y": 256,
    "z": 55,
    "classes": "transparent"
  },
  "play2": {
    "type": "holder",
    "id": "play2",
    "x": 688,
    "y": 540,
    "width": 111,
    "height": 168,
    "z": 50,
    "movable": false,
    "movableInEdit": true,
    "inheritFrom": {
      "play1": [
        "cardPlayedRoutine",
        "onEnter",
        "css"
      ]
    },
    "classes": "transparent"
  },
  "play3": {
    "type": "holder",
    "id": "play3",
    "x": 898,
    "y": 540,
    "width": 111,
    "height": 168,
    "z": 63,
    "movable": false,
    "movableInEdit": true,
    "inheritFrom": {
      "play1": [
        "cardPlayedRoutine",
        "onEnter",
        "css"
      ]
    },
    "classes": "transparent"
  },
  "background": {
    "id": "background",
    "width": 1600,
    "height": 1000,
    "layer": -10,
    "z": 82815,
    "movable": false,
    "movableInEdit": false,
    "css": {
      "background-color": "#a1bdff",
      "background-repeat": "repeat",
      "background-size": "20px",
      "opacity": 0.5
    },
    "image": "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='52' height='52' viewBox='0 0 52 52'%3E%3Cpath fill='%23004cff' fill-opacity='0.51' d='M0 17.83V0h17.83a3 3 0 0 1-5.66 2H5.9A5 5 0 0 1 2 5.9v6.27a3 3 0 0 1-2 5.66zm0 18.34a3 3 0 0 1 2 5.66v6.27A5 5 0 0 1 5.9 52h6.27a3 3 0 0 1 5.66 0H0V36.17zM36.17 52a3 3 0 0 1 5.66 0h6.27a5 5 0 0 1 3.9-3.9v-6.27a3 3 0 0 1 0-5.66V52H36.17zM0 31.93v-9.78a5 5 0 0 1 3.8.72l4.43-4.43a3 3 0 1 1 1.42 1.41L5.2 24.28a5 5 0 0 1 0 5.52l4.44 4.43a3 3 0 1 1-1.42 1.42L3.8 31.2a5 5 0 0 1-3.8.72zm52-14.1a3 3 0 0 1 0-5.66V5.9A5 5 0 0 1 48.1 2h-6.27a3 3 0 0 1-5.66-2H52v17.83zm0 14.1a4.97 4.97 0 0 1-1.72-.72l-4.43 4.44a3 3 0 1 1-1.41-1.42l4.43-4.43a5 5 0 0 1 0-5.52l-4.43-4.43a3 3 0 1 1 1.41-1.41l4.43 4.43c.53-.35 1.12-.6 1.72-.72v9.78zM22.15 0h9.78a5 5 0 0 1-.72 3.8l4.44 4.43a3 3 0 1 1-1.42 1.42L29.8 5.2a5 5 0 0 1-5.52 0l-4.43 4.44a3 3 0 1 1-1.41-1.42l4.43-4.43a5 5 0 0 1-.72-3.8zm0 52c.13-.6.37-1.19.72-1.72l-4.43-4.43a3 3 0 1 1 1.41-1.41l4.43 4.43a5 5 0 0 1 5.52 0l4.43-4.43a3 3 0 1 1 1.42 1.41l-4.44 4.43c.36.53.6 1.12.72 1.72h-9.78zm9.75-24a5 5 0 0 1-3.9 3.9v6.27a3 3 0 1 1-2 0V31.9a5 5 0 0 1-3.9-3.9h-6.27a3 3 0 1 1 0-2h6.27a5 5 0 0 1 3.9-3.9v-6.27a3 3 0 1 1 2 0v6.27a5 5 0 0 1 3.9 3.9h6.27a3 3 0 1 1 0 2H31.9z'%3E%3C/path%3E%3C/svg%3E"
  },
  "sortB": {
    "type": "button",
    "id": "sortB",
    "x": 1711,
    "y": 775,
    "z": 123,
    "text": "SORT",
    "clickRoutine": [
      {
        "func": "SORT",
        "holder": "hand",
        "key": "sortingKey"
      }
    ]
  },
  "scoreB": {
    "type": "button",
    "id": "scoreB",
    "x": 1481,
    "y": 675,
    "z": 148,
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;font-size: 25px",
    "text": "SCORE",
    "clickRoutine": [
      {
        "func": "SELECT",
        "type": "card",
        "property": "parent",
        "relation": "in",
        "value": [
          "play1",
          "play2",
          "play3"
        ],
        "collection": "playedCards"
      },
      "var lastWon = ${PROPERTY winningSeat OF title}",
      {
        "func": "SET",
        "collection": "playedCards",
        "property": "parent",
        "value": "won${lastWon.4}"
      },
      {
        "func": "FLIP",
        "face": 0,
        "holder": "won${lastWon.4}"
      },
      {
        "func": "FOREACH",
        "in": [
          1,
          2,
          3
        ],
        "loopRoutine": [
          {
            "func": "SELECT",
            "type": "card",
            "property": "_ancestor",
            "value": "won${value}",
            "collection": "wonCards"
          },
          {
            "func": "COUNT",
            "collection": "wonCards",
            "variable": "wonCardsCount"
          },
          "var score = ${wonCardsCount} / 3",
          {
            "func": "GET",
            "collection": "wonCards",
            "property": "points",
            "aggregation": "sum",
            "variable": "jacksScore"
          },
          "var score = ${score} + ${jacksScore}",
          {
            "func": "SCORE",
            "round": "${PROPERTY text OF roundL}",
            "seats": [
              "seat${value}"
            ],
            "value": "${score}"
          }
        ]
      },
      {
        "func": "FOREACH",
        "in": [
          "1",
          "2",
          "3"
        ],
        "loopRoutine": [
          {
            "func": "SELECT",
            "property": "parent",
            "value": "won${value}",
            "type": "card",
            "collection": "wonCards"
          },
          {
            "func": "SET",
            "property": "parent",
            "value": "hand",
            "collection": "wonCards"
          },
          "var seat = 'seat' concat ${value}",
          "var owner = ${PROPERTY player OF $seat}",
          {
            "func": "SET",
            "property": "owner",
            "value": "${owner}",
            "collection": "wonCards"
          },
          {
            "func": "SET",
            "property": "activeFace",
            "value": 1,
            "collection": "wonCards"
          },
          {
            "func": "CLICK",
            "collection": [
              "sortB"
            ],
            "count": 2
          }
        ]
      },
      {
        "func": "SELECT",
        "property": "undoProperties",
        "relation": "!=",
        "value": null
      },
      {
        "func": "FOREACH",
        "loopRoutine": [
          {
            "func": "SET",
            "property": "undoProperties",
            "value": null
          }
        ]
      },
      {
        "func": "SET",
        "property": "undoLevel",
        "value": 0,
        "collection": [
          "undoB"
        ]
      },
      {
        "func": "SET",
        "property": "onlyVisibleForSeat",
        "value": "",
        "collection": [
          "undoB"
        ]
      },
      {
        "func": "LABEL",
        "label": "roundL",
        "mode": "inc",
        "value": 1
      },
      {
        "func": "SET",
        "property": "scale",
        "value": 0,
        "collection": "thisButton"
      },
      {
        "func": "GET",
        "collection": [
          "scoreboard"
        ],
        "property": "_totals",
        "variable": "total"
      },
      "var endGame = false",
      {
        "func": "FOREACH",
        "in": "${total}",
        "loopRoutine": [
          {
            "func": "IF",
            "operand1": "${value}",
            "relation": ">=",
            "operand2": 20,
            "thenRoutine": [
              "var endGame = true"
            ]
          }
        ]
      },
      {
        "func": "IF",
        "condition": "${endGame}",
        "thenRoutine": [
          {
            "func": "SET",
            "property": "scale",
            "value": 0,
            "collection": [
              "r45z"
            ]
          }
        ],
        "elseRoutine": [
          {
            "func": "SET",
            "collection": [
              "r45z"
            ],
            "property": "scale",
            "value": 1
          }
        ]
      },
      {
        "func": "SET",
        "property": "onlyVisibleForSeat",
        "value": "",
        "collection": [
          "takeB"
        ]
      }
    ],
    "dealProperties": {
      "scale": 0
    },
    "svgReplaces": {},
    "scale": 0
  },
  "roundL": {
    "id": "roundL",
    "x": 1461,
    "y": 652,
    "z": 16,
    "text": 1,
    "css": "font-size: 40px",
    "width": 50,
    "height": 50,
    "type": "label",
    "editable": true,
    "resetProperties": {
      "text": 1
    },
    "scale": 0
  },
  "r46z": {
    "type": "button",
    "text": "move to score",
    "clickRoutine": [
      {
        "func": "SELECT",
        "type": "seat",
        "property": "player",
        "relation": "!=",
        "value": "",
        "collection": "seats"
      },
      {
        "func": "FOREACH",
        "collection": "seats",
        "loopRoutine": [
          "var player = ${PROPERTY player OF $widgetID}",
          "var won = 'won' concat ${widgetID.4}",
          {
            "func": "SELECT",
            "type": "card",
            "property": "owner",
            "value": "${player}",
            "collection": "cards"
          },
          {
            "func": "FOREACH",
            "collection": "cards",
            "loopRoutine": [
              {
                "func": "SET",
                "property": "owner",
                "value": null
              },
              {
                "func": "SET",
                "property": "parent",
                "value": "${won}"
              }
            ]
          }
        ]
      },
      {
        "func": "SET",
        "collection": [
          "scoreB"
        ],
        "property": "scale",
        "value": 1
      }
    ],
    "x": 1757,
    "y": 574,
    "z": 129,
    "id": "r46z",
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;"
  },
  "r47z": {
    "type": "button",
    "text": "RESET",
    "clickRoutine": [
      {
        "func": "CALL",
        "widget": "title",
        "routine": "propertiesRoutine",
        "arguments": {
          "properties": "resetProperties"
        }
      },
      {
        "func": "RECALL",
        "holder": "deckH"
      },
      {
        "func": "FLIP",
        "holder": "deckH",
        "face": 0
      },
      {
        "func": "SHUFFLE",
        "holder": "deckH"
      },
      {
        "func": "SELECT",
        "property": "undoProperties",
        "relation": "!=",
        "value": null
      },
      {
        "func": "FOREACH",
        "loopRoutine": [
          {
            "func": "SET",
            "property": "undoProperties",
            "value": null
          }
        ]
      }
    ],
    "x": 15,
    "y": 14,
    "z": 141,
    "id": "r47z",
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;font-size: 10px;",
    "width": 40,
    "height": 40
  },
  "undoB": {
    "type": "button",
    "id": "undoB",
    "x": 353,
    "y": 712,
    "z": 150,
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;font-size: 25px",
    "text": "UNDO",
    "clickRoutine": [
      {
        "func": "FOREACH",
        "in": [
          1,
          2
        ],
        "loopRoutine": [
          {
            "func": "SELECT",
            "property": "undoProperties",
            "relation": "!=",
            "value": null
          },
          {
            "func": "FOREACH",
            "loopRoutine": [
              "var undoLevel = ${PROPERTY undoLevel}",
              "var undoPropertiesForWidget = ${PROPERTY undoProperties OF $widgetID}",
              "var undoPropertiesForWidgetForLevel = ${undoPropertiesForWidget.$undoLevel}",
              "var widget = ${widgetID}",
              {
                "func": "IF",
                "operand1": "${undoPropertiesForWidgetForLevel}",
                "operand2": null,
                "elseRoutine": [
                  {
                    "func": "FOREACH",
                    "in": "${undoPropertiesForWidgetForLevel}",
                    "loopRoutine": [
                      {
                        "func": "SET",
                        "property": "${key}",
                        "value": "${value}",
                        "collection": [
                          "${widget}"
                        ]
                      }
                    ]
                  },
                  "var undoPropertiesForWidget.$undoLevel = {}",
                  {
                    "func": "SET",
                    "property": "undoProperties",
                    "value": "${undoPropertiesForWidget}",
                    "collection": [
                      "${widget}"
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      "var undoLevel = ${PROPERTY undoLevel}",
      {
        "func": "IF",
        "operand1": "${undoLevel}",
        "operand2": 0,
        "elseRoutine": [
          "var undoLevel = ${undoLevel} - 1",
          {
            "func": "SET",
            "property": "undoLevel",
            "value": "${undoLevel}",
            "collection": "thisButton"
          },
          {
            "func": "SORT",
            "holder": "hand",
            "key": null
          }
        ]
      },
      {
        "func": "IF",
        "operand1": "${PROPERTY undoLevel}",
        "operand2": 0,
        "thenRoutine": [
          {
            "func": "SET",
            "property": "onlyVisibleForSeat",
            "value": "",
            "collection": "thisButton"
          }
        ],
        "elseRoutine": [
          "var undoSeat = ${PROPERTY undoSeat}",
          "var undoLevel = ${PROPERTY undoLevel}",
          "var seat = ${undoSeat.$undoLevel}",
          {
            "func": "SET",
            "property": "onlyVisibleForSeat",
            "value": "${seat}",
            "collection": "thisButton"
          }
        ]
      },
      {
        "func": "CLICK",
        "collection": [
          "sortB"
        ],
        "count": 4
      }
    ],
    "color": "red",
    "background": "blue",
    "undoLevel": 0,
    "resetProperties": {
      "undoLevel": 0,
      "undoSeat": {},
      "onlyVisibleForSeat": ""
    },
    "setRoutine": [
      "var widget = ${widget}",
      "var property = ${property}",
      "var value = ${value}",
      "var undoPropertiesForWidget = ${PROPERTY undoProperties OF $widget}",
      "var undoLevel = ${PROPERTY undoLevel}",
      "var currentValue = ${PROPERTY $property OF $widget}",
      {
        "func": "IF",
        "operand1": "${undoPropertiesForWidget}",
        "operand2": null,
        "thenRoutine": [
          "var undoPropertiesForWidget = {}",
          "var undoLevelProperties = {}",
          "var undoLevelProperties.$property = ${currentValue}",
          "var undoPropertiesForWidget.$undoLevel = ${undoLevelProperties}"
        ],
        "elseRoutine": [
          "var undoPropertiesForWidgetForLevel = ${undoPropertiesForWidget.$undoLevel}",
          "var undoPropertiesLevel = ${undoPropertiesForWidget.$property}",
          {
            "func": "IF",
            "operand1": "${undoPropertiesForWidgetForLevel}",
            "operand2": null,
            "thenRoutine": [
              "var undoLevelProperties = {}",
              "var undoLevelProperties.$property = ${currentValue}",
              "var undoPropertiesForWidget.$undoLevel = ${undoLevelProperties}"
            ],
            "elseRoutine": [
              "var currentUndoValue = ${undoPropertiesForWidgetForLevel.$property}",
              {
                "func": "IF",
                "operand1": "${currentUndoValue}",
                "operand2": null,
                "thenRoutine": [
                  "var undoPropertiesForWidgetForLevel.$property = ${PROPERTY $property OF $widget}"
                ]
              }
            ]
          }
        ]
      },
      {
        "func": "SET",
        "property": "${property}",
        "value": "${value}",
        "collection": [
          "${widget}"
        ]
      },
      {
        "func": "SET",
        "property": "undoProperties",
        "value": "${undoPropertiesForWidget}",
        "collection": [
          "${widget}"
        ]
      }
    ],
    "dealProperties": {
      "undoLevel": 0,
      "undoSeat": {},
      "onlyVisibleForSeat": ""
    },
    "updateUndoLevelRoutine": [
      "var undoLevel = ${PROPERTY undoLevel}",
      "var undoLevel = ${undoLevel} + 1",
      {
        "func": "SET",
        "property": "undoLevel",
        "value": "${undoLevel}",
        "collection": "thisButton"
      },
      "var undoSeat = ${PROPERTY undoSeat}",
      {
        "func": "IF",
        "operand1": "${undoSeat}",
        "operand2": null,
        "thenRoutine": [
          "var undoSeat = {}"
        ]
      },
      "var undoSeat.$undoLevel = ${seat}",
      {
        "func": "SET",
        "property": "undoSeat",
        "value": "${undoSeat}",
        "collection": "thisButton"
      },
      {
        "func": "SET",
        "property": "onlyVisibleForSeat",
        "value": "${seat}",
        "collection": "thisButton"
      }
    ],
    "undoSeat": {},
    "onlyVisibleForSeat": "",
    "onlyVisibleForSeat ": ""
  },
  "undoB1": {
    "type": "button",
    "id": "undoB1",
    "x": -318,
    "y": 637,
    "z": 138,
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;",
    "text": "turn swap",
    "clickRoutine": [
      {
        "func": "SET",
        "property": "turn",
        "value": true,
        "collection": [
          "seat1"
        ]
      },
      {
        "func": "SET",
        "property": "turn",
        "value": false,
        "collection": [
          "seat2"
        ]
      }
    ],
    "color": "red",
    "background": "blue"
  },
  "mtk2": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 01",
    "id": "mtk2",
    "z": 960,
    "parent": "ymk3",
    "enabled": true
  },
  "jcr0": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 02",
    "id": "jcr0",
    "z": 923,
    "parent": "ymk3",
    "enabled": true
  },
  "oqz6": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 03",
    "id": "oqz6",
    "z": 941,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "nm7z": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 04",
    "id": "nm7z",
    "z": 943,
    "parent": "ymk3",
    "enabled": true
  },
  "8j2e": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 05",
    "id": "8j2e",
    "z": 921,
    "parent": "ymk3",
    "enabled": true
  },
  "nidv": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 06",
    "id": "nidv",
    "z": 936,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "x6wm": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 07",
    "id": "x6wm",
    "z": 959,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "8xmy": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 08",
    "id": "8xmy",
    "z": 939,
    "parent": "ymk3",
    "enabled": true
  },
  "w9bd": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 09",
    "id": "w9bd",
    "z": 954,
    "parent": "ymk3",
    "enabled": false
  },
  "gdxx": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 10",
    "id": "gdxx",
    "z": 917,
    "parent": "ymk3",
    "enabled": true
  },
  "68ew": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 2J",
    "id": "68ew",
    "z": 924,
    "parent": "ymk3",
    "enabled": true
  },
  "hitm": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 3Q",
    "id": "hitm",
    "z": 945,
    "parent": "ymk3",
    "enabled": false
  },
  "4oxw": {
    "deck": "deck",
    "type": "card",
    "cardType": "C 4K",
    "id": "4oxw",
    "z": 911,
    "parent": "ymk3",
    "enabled": false
  },
  "nj2t": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 01",
    "id": "nj2t",
    "z": 940,
    "parent": "ymk3",
    "enabled": true
  },
  "m5pt": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 02",
    "id": "m5pt",
    "z": 932,
    "parent": "ymk3",
    "enabled": true
  },
  "n013": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 03",
    "id": "n013",
    "z": 919,
    "parent": "ymk3",
    "enabled": true
  },
  "3vbp": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 04",
    "id": "3vbp",
    "z": 925,
    "parent": "ymk3",
    "enabled": true
  },
  "3go1": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 05",
    "id": "3go1",
    "z": 913,
    "parent": "ymk3",
    "enabled": true
  },
  "udk3": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 06",
    "id": "udk3",
    "z": 920,
    "parent": "ymk3",
    "enabled": true
  },
  "zfw6": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 07",
    "id": "zfw6",
    "z": 944,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "oj64": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 08",
    "id": "oj64",
    "z": 916,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "1sbv": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 09",
    "id": "1sbv",
    "z": 938,
    "parent": "ymk3",
    "enabled": true
  },
  "czra": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 10",
    "id": "czra",
    "z": 953,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "j3lu": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 2J",
    "id": "j3lu",
    "z": 933,
    "parent": "ymk3",
    "enabled": true
  },
  "6grf": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 3Q",
    "id": "6grf",
    "z": 929,
    "parent": "ymk3",
    "enabled": true
  },
  "sgh2": {
    "deck": "deck",
    "type": "card",
    "cardType": "D 4K",
    "id": "sgh2",
    "z": 926,
    "parent": "ymk3",
    "enabled": true
  },
  "3gvx": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 01",
    "id": "3gvx",
    "z": 956,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "g2hk": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 02",
    "id": "g2hk",
    "z": 915,
    "parent": "ymk3",
    "enabled": true
  },
  "pi73": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 03",
    "id": "pi73",
    "z": 918,
    "parent": "ymk3",
    "enabled": true
  },
  "cr2i": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 04",
    "id": "cr2i",
    "z": 937,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "97pz": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 05",
    "id": "97pz",
    "z": 951,
    "parent": "ymk3",
    "enabled": true
  },
  "5f2s": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 06",
    "id": "5f2s",
    "z": 948,
    "parent": "ymk3",
    "enabled": true
  },
  "9r6g": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 07",
    "id": "9r6g",
    "z": 914,
    "parent": "ymk3",
    "enabled": true
  },
  "zttv": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 08",
    "id": "zttv",
    "z": 927,
    "parent": "ymk3",
    "enabled": true
  },
  "a32g": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 09",
    "id": "a32g",
    "z": 935,
    "parent": "ymk3",
    "enabled": true
  },
  "x6rp": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 10",
    "id": "x6rp",
    "z": 946,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "g2en": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 2J",
    "id": "g2en",
    "z": 931,
    "parent": "ymk3",
    "enabled": true
  },
  "epn7": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 3Q",
    "id": "epn7",
    "z": 950,
    "parent": "ymk3",
    "enabled": true
  },
  "uep3": {
    "deck": "deck",
    "type": "card",
    "cardType": "S 4K",
    "id": "uep3",
    "z": 958,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "orku": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 01",
    "id": "orku",
    "z": 912,
    "parent": "ymk3",
    "enabled": true
  },
  "nn5n": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 02",
    "id": "nn5n",
    "z": 930,
    "parent": "ymk3",
    "enabled": true
  },
  "xxmm": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 03",
    "id": "xxmm",
    "z": 942,
    "parent": "ymk3",
    "enabled": true
  },
  "k068": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 04",
    "id": "k068",
    "z": 952,
    "parent": "ymk3",
    "enabled": true
  },
  "lm1r": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 05",
    "id": "lm1r",
    "z": 949,
    "parent": "ymk3",
    "enabled": true
  },
  "qn1c": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 06",
    "id": "qn1c",
    "z": 928,
    "parent": "ymk3",
    "enabled": true
  },
  "3kqy": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 07",
    "id": "3kqy",
    "z": 947,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "xb93": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 08",
    "id": "xb93",
    "z": 910,
    "parent": "ymk3",
    "enabled": true
  },
  "9f4n": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 09",
    "id": "9f4n",
    "z": 955,
    "parent": "ymk3",
    "enabled": true
  },
  "f1hl": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 10",
    "id": "f1hl",
    "z": 934,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "dy89": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 2J",
    "id": "dy89",
    "z": 957,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "z0z9": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 3Q",
    "id": "z0z9",
    "z": 922,
    "parent": "ymk3",
    "enabled": true,
    "css": {
      ":hover": {
        "box-shadow": "0px 0px 10px 5px blue"
      }
    }
  },
  "ava3": {
    "deck": "deck",
    "type": "card",
    "cardType": "H 4K",
    "id": "ava3",
    "z": 909,
    "parent": "ymk3",
    "enabled": true
  },
  "scoreboard": {
    "type": "scoreboard",
    "id": "scoreboard",
    "y": 791,
    "z": 153,
    "x": 1294
  },
  "takeB": {
    "type": "button",
    "id": "takeB",
    "x": 1032,
    "y": 719,
    "z": 151,
    "color": "red",
    "css": "background-color: #a1bdff; border: solid 1px blue;color: black;font-size: 25px",
    "onlyVisibleForSeat": "",
    "text": "TAKE",
    "background": "blue",
    "dealProperties": {
      "onlyVisibleForSeat": ""
    },
    "onlyVisibleForSeat ": "",
    "resetProperties": {
      "onlyVisibleForSeat": ""
    },
    "clickRoutine": [
      {
        "func": "SELECT",
        "type": "card",
        "property": "parent",
        "relation": "in",
        "value": [
          "play1",
          "play2",
          "play3"
        ],
        "collection": "cards"
      },
      {
        "func": "SELECT",
        "type": "card",
        "property": "enabled",
        "value": false,
        "source": "cards",
        "collection": "oldCards"
      },
      "var wonSeat = ${PROPERTY wonSeat OF title}",
      {
        "func": "FOREACH",
        "collection": "oldCards",
        "loopRoutine": [
          {
            "func": "CALL",
            "widget": "undoB",
            "routine": "setRoutine",
            "arguments": {
              "widget": "${widgetID}",
              "property": "parent",
              "value": "won${wonSeat.4}"
            }
          },
          {
            "func": "CALL",
            "widget": "undoB",
            "routine": "setRoutine",
            "arguments": {
              "widget": "${widgetID}",
              "property": "activeFace",
              "value": 0
            }
          }
        ]
      },
      {
        "func": "CALL",
        "widget": "undoB",
        "routine": "setRoutine",
        "arguments": {
          "widget": "title",
          "property": "playedCards",
          "value": 0
        }
      },
      {
        "func": "CALL",
        "widget": "undoB",
        "routine": "setRoutine",
        "arguments": {
          "widget": "${thisID}",
          "property": "onlyVisibleForSeat",
          "value": ""
        }
      }
    ]
  },
  "ymk3": {
    "type": "pile",
    "parent": "deckH",
    "x": 4,
    "y": 4,
    "width": 103,
    "height": 160,
    "id": "ymk3"
  }
}